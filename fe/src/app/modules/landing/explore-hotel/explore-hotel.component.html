<div class="w-full h-full max-w-[1920px] flex-auto relative [contain:paint]">
    <div #headerRef class="sticky top-0 z-10 flex flex-col items-center justify-center w-full px-16 bg-center bg-no-repeat bg-cover pt-28"
        [style.background-image]="'url('  + crrImage + ')'"
    >
        <div class="absolute top-0 left-0 w-full h-full bg-primary/50"></div>
        <div *ngIf="showSecondDiv" class="z-10 flex flex-col w-[calc(100%+60px)] px-[30px] text-black bg-white gap-2 py-2"
            [class.hidden]="isSmallScreen && !showSecondDiv"
        >
            <div class="flex justify-end">
                <button (click)="toggleToDiv1()" class="px-2 py-1 text-center text-black bg-yellow-500 text-[14px] font-avenir font-black uppercase">Edit</button>
            </div>
            <div class="flex justify-between">
                <span class="font-avenir text-[16px] font-normal">25 October - 3 November</span>
                <span class="font-avenir text-[16px] font-normal">1 Room, Guests</span>
            </div>
        </div>
        <div *ngIf="!showSecondDiv" class="sticky z-10 flex w-full h-auto max-w-full mt-5 bg-white/90 max-lg:bg-transparent mb-7"
            [class.hidden]="!isSmallScreen && showSecondDiv"
        >
            
            <form *ngIf="searchData" (ngSubmit)="submitSearch()" class="flex w-full max-w-full p-2 bg-transparent max-lg:grid max-lg:grid-cols-1 max-lg:gap-3">
                <div class="flex flex-col pl-2 min-w-[20%] max-lg:bg-white">
                    <span class="font-mono text-black">{{translocoService.translate('home-page.location')|uppercase}}</span>
                    <mat-select name="selectedDes" [(ngModel)]="searchData.destination" [placeholder]="translocoService.translate('home-page.choose_location')">
                        
                        <mat-option *ngFor="let item of optionsDestinations" [value]="item.id">
                        {{ item.name }}
                        </mat-option>
                        <mat-option class="hidden" [value]="1">
                        1
                        </mat-option>
                    </mat-select>
                </div>
                <div class="flex min-w-[70%] gap-3 max-lg:grid-cols-2 max-lg:grid">
                    <button type="button" class="flex flex-col pl-2 border-l border-black/50 min-w-[16%] max-lg:bg-white" (click)="toggleCalendarCheckin()">
                        <span class="self-start font-mono text-black">CHECK IN</span>
                        <input readonly [min]="today" [matDatepicker]="pickerCheckin" name="pickerCheckin" [(ngModel)]="checkInDate"  [placeholder]="translocoService.translate('home-page.choose_day')" class="text-black placeholder:font-mono">
                        <mat-datepicker #pickerCheckin></mat-datepicker>
                    </button>
                    <button type="button" [disabled]="!checkInDate" class="flex flex-col pl-2 border-l border-black/50 min-w-[16%] max-lg:bg-white" (click)="toggleCalendarCheckout()">
                        <span class="self-start font-mono text-black">CHECK OUT</span>
                        <input readonly [min]="minCheckoutDate" [matDatepicker]="pickerCheckout" name="pickerCheckout" [(ngModel)]="checkOutDate"  [placeholder]="translocoService.translate('home-page.choose_day')" class="text-black placeholder:font-mono">
                        <mat-datepicker #pickerCheckout></mat-datepicker>
                    </button>
                    <div class="relative min-w-[20%] max-lg:min-w-0 max-lg:bg-white">
                        <button
                            type="button"
                            class="flex flex-col h-full pl-2 border-l border-black/50"
                            (click)="toggleGuestSelector()"
                        >
                            <span class="self-start font-mono text-black">{{translocoService.translate('home-page.guest')+ ', ' + translocoService.translate('home-page.room')}}</span>
                            <span class="self-start font-mono text-black text-start">{{ guestSummary }}</span>
                        </button>

                        <!-- Popup chọn khách -->
                        <div
                            *ngIf="showGuestSelector"
                            class="absolute left-0 z-50 flex flex-col gap-3 p-3 mt-2 text-black border border-gray-300 rounded-lg shadow-lg bg-[#F5F5F5] w-max"
                        >
                            <div class="flex flex-col">
                                <span class="text-xl font-charm">{{translocoService.translate('home-page.how_many_guests')}}</span>
                                <div class="flex items-center justify-between p-2 text-black">
                                    <span class="font-mono">{{translocoService.translate('home-page.room')}}</span>
                                    <div class="flex items-center gap-2">
                                        <button type="button" class="px-2" (click)="removeRoom()">-</button>
                                        <span class="font-mono">{{ roomList.length }}</span>
                                        <button [attr.disabled]="roomList.length >= 5 ? true : null" type="button" class="px-2" (click)="addRoom()">+</button>
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-xl font-charm">{{translocoService.translate('home-page.how_many_rooms')}}</span>
                                <div class="grid gap-3" [ngClass]="roomList.length > 1 ? 'grid-cols-1 lg:grid-cols-2' : 'grid-cols-1'">
                                    <div class="flex flex-col bg-white shadow-md"  *ngFor="let r of roomList">
                                        <div class="flex items-center justify-between p-2 text-black ">
                                            <span class="font-mono">{{translocoService.translate('home-page.adults')}}</span>
                                            <div class="flex items-center gap-2">
                                                <button type="button" class="px-2" (click)="r.adults = Math.max(1, r.adults - 1)">-</button>
                                                <span class="font-mono">{{ r.adults }}</span>
                                                <button [attr.disabled]="r.adults >= 10 ? true : null" type="button" class="px-2" (click)="r.adults = r.adults + 1">+</button>
                                            </div>
                                        </div>
                                        <div class="flex items-center justify-between p-2 text-black">
                                            <span class="font-mono">{{translocoService.translate('home-page.children')}}</span>
                                            <div class="flex items-center gap-2">
                                                <button type="button" class="px-2" (click)="r.children = Math.max(0, r.children - 1)">-</button>
                                                <span class="font-mono">{{ r.children }}</span>
                                                <button [attr.disabled]="r.children >= 6 ? true : null" type="button" class="px-2" (click)="r.children = r.children + 1">+</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="text-right">
                                <button type="button" class="px-3 py-1 font-mono text-white bg-black rounded" (click)="closeGuestSelector()">{{translocoService.translate('home-page.done')}}</button>
                            </div>
                        </div>
                    </div>
                    <div class="flex flex-col pl-2 min-w-[16%] max-lg:min-w-0 border-l border-black/50 max-lg:bg-white">
                        <span class="font-mono text-black">Code</span>
                        <input type="text" placeholder="" class="text-black placeholder:font-mono"/>
                    </div>
                </div>
                
                <button type="submit" class="flex items-center justify-center gap-1 px-2 ml-auto bg-yellow-500">
                    <mat-icon class="text-black" [svgIcon]="'heroicons_outline:magnifying-glass'"></mat-icon>
                    <span class="font-mono text-black">{{translocoService.translate('home-page.search')}}</span>
                </button>
            </form>
            <div class="flex items-start"
                [class.hidden]="!isSmallScreen && !showSecondDiv"
            >
                <button (click)="toggleToDiv2()" class="px-1 py-1 text-center text-black bg-yellow-500 text-[14px] font-avenir font-black uppercase rounded-full"><mat-icon class="text-[13px] text-black">close</mat-icon></button>
            </div>
        </div>
        
    </div>
    
    <div class="sticky z-[9] w-full h-auto px-16 mt-4 bg-white" [style.top.px]="headerHeight-1">
        <div class="w-full flex justify-end border-b border-[#d4d4d4]">
            <div class="flex border border-[#d4d4d4] rounded-lg overflow-hidden items-center mb-3">
                <select class="custom-select uppercase py-2 pl-2 pr-9 focus:ring-0 outline-none border-r border-[#d4d4d4]">
                    <option class="uppercase" value="#">relevance</option>
                </select>
                <mat-icon class="text-black">keyboard_arrow_down</mat-icon>
            </div>
        </div>
    </div>
    
    <div class="absolute z-[3] flex w-full h-full px-16 mt-14 max-md:hidden">
        <app-map class="ml-auto w-[41%] h-[765px] sticky" [listData]="listHotel" [style.top.px]="headerHeight + 60"></app-map>
    </div>
    
    <div class="z-0 flex flex-wrap w-full px-16 mt-8 h-max">
        <span class="w-full font-avenir text-black text-[16px] font-normal">hotels</span>
        <div class="grid grid-cols-[59%_41%] w-full mt-5 max-md:grid-cols-1">
            <div class="flex flex-col mt-3 mr-6 z-[4]">
                <span class="w-full mb-4 font-clearface text-[26px]">{{total}} hotels available for your selected dates</span>
                <ng-container *ngFor="let hotel of listHotel; let i = index">
                    <div class="flex w-full gap-3 mb-5 h-max max-lg:flex-col">
                        <div class="relative w-[305px] max-lg:w-full">
                            <!-- Swiper -->
                            <swiper-container
                                #swiperEl
                                (click)="chooseHotel(hotel.slug, hotel.uuid)"
                                init="false"
                                class="overflow-hidden aspect-[3/2]"
                            >
                                <swiper-slide *ngFor="let img of hotel.images">
                                <img [src]="baseUrl + img.imageUrl" class="object-cover w-full h-full" />
                                </swiper-slide>
                            </swiper-container>

                            <!-- Custom controls -->
                            <div
                                class="absolute bottom-0 left-0 right-0 flex z-[9] items-center justify-between bg-[#ffe6d2] px-3 py-1 text-[14px]"
                            >
                                <div class="flex items-center gap-2 text-[#855d2c] font-[500]">
                                <span>{{ currentIndexes[i] + 1 }}/{{ hotel.images.length }}</span>
                                </div>

                                <div class="flex items-center gap-2">
                                <button (click)="prevSlide(i, swipers)" class="text-[#855d2c] hover:opacity-70">
                                    &#10094;
                                </button>
                                <button (click)="nextSlide(i, swipers)" class="text-[#855d2c] hover:opacity-70">
                                    &#10095;
                                </button>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col flex-grow">
                            <span class="w-full font-clearface text-[30px] hover:cursor-pointer" (click)="chooseHotel(hotel.slug, hotel.uuid)">{{hotel.name}}</span>
                            <span class="inline-flex mb-[30px] items-center w-full italic font-parisienne text-[12px]"><img src="assets/images/map/hotel-icon.png" class="w-[14px] h-4 align-middle mr-2"/>test</span>
                            <span class="w-full font-avenir text-[16px]">Total min price</span>
                            <div class="flex items-end gap-6 mt-auto">
                                <div class="px-6 py-2 bg-yellow-500 font-avenir text-[14px] font-black hover:cursor-pointer" (click)="chooseHotel(hotel.slug, hotel.uuid)">BOOK NOW</div>
                                <span class="font-avenir py-2 text-[14px] font-black">QUICK VIEW</span>
                                <div class="relative flex flex-wrap justify-center ml-auto h-[5rem] w-20">
                                    <img src="assets/images/explore-hotel/rating.png" class="absolute top-0 w-16 h-16 -translate-x-1/2 left-1/2"/>
                                    <span class="mt-[1rem] font-black w-full text-center">4.3</span>
                                    <span class="w-full mt-auto text-center text-[12px]">100 reviews</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>

                <span class="w-full mb-4 font-clearface text-[26px] mt-3">Unavailable hotels during selected dates</span>
                <ng-container *ngFor="let hotel of listExcludeHotel; let i = index">
                    <div class="flex w-full gap-3 mb-5 h-max max-lg:flex-col">
                        <div class="relative w-[305px] max-lg:w-full">
                            <!-- Swiper -->
                            <swiper-container
                                (click)="chooseHotel(hotel.slug, hotel.uuid)"
                                #swiperE2
                                init="false"
                                class="overflow-hidden aspect-[3/2]"
                            >
                                <swiper-slide *ngFor="let img of hotel.images">
                                <img [src]="baseUrl + img.imageUrl" class="object-cover w-full h-full" />
                                </swiper-slide>
                            </swiper-container>

                            <!-- Custom controls -->
                            <div
                                class="absolute bottom-0 left-0 right-0 flex z-[9] items-center justify-between bg-[#ffe6d2] px-3 py-1 text-[14px]"
                            >
                                <div class="flex items-center gap-2 text-[#855d2c] font-[500]">
                                <span>{{ currentIndexes2[i] + 1 }}/{{ hotel.images.length }}</span>
                                </div>

                                <div class="flex items-center gap-2">
                                <button (click)="prevSlide(i, swipers2)" class="text-[#855d2c] hover:opacity-70">
                                    &#10094;
                                </button>
                                <button (click)="nextSlide(i, swipers2)" class="text-[#855d2c] hover:opacity-70">
                                    &#10095;
                                </button>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col flex-grow">
                            <div class="w-full py-[10px] px-[30px] bg-[#f4f4f4]">Hotel not available for selected dates.</div>
                            <span class="w-full font-clearface text-[30px] hover:cursor-pointer" (click)="chooseHotel(hotel.slug, hotel.uuid)">{{hotel.name}}</span>
                            <span class="inline-flex mb-[30px] items-center w-full italic font-parisienne text-[12px]"><img src="assets/images/map/hotel-icon.png" class="w-[14px] h-4 align-middle mr-2"/>test</span>
                            <span class="w-full font-avenir text-[16px]">Total min price</span>
                            <div class="flex items-end gap-6 mt-auto">
                                <div class="px-6 py-2 bg-yellow-500 font-avenir text-[14px] font-black hover:cursor-pointer" (click)="chooseHotel(hotel.slug, hotel.uuid)">BOOK NOW</div>
                                <span class="font-avenir py-2 text-[14px] font-black">QUICK VIEW</span>
                                <div class="relative flex flex-wrap justify-center ml-auto h-[5rem] w-20">
                                    <img src="assets/images/explore-hotel/rating.png" class="absolute top-0 w-16 h-16 -translate-x-1/2 left-1/2"/>
                                    <span class="mt-[1rem] font-black w-full text-center">4.3</span>
                                    <span class="w-full mt-auto text-center text-[12px]">100 reviews</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <button [disabled]="!buttonNext" type="button" class="z-10 hover:bg-yellow-400" (click)="loadMoreHotes()">Load more</button>
            </div>
            <div #mapContainer class="h-[756px] hidden">
                <app-map class="w-full h-full"></app-map>
            </div>    
        </div>
    </div>
    
</div>